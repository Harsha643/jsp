<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register</title>
    <style>
        
        
        *{
            margin: 0;
            padding: 0;
            box-sizing: border-box;

        }


        .form-container{
            display: flex;
            height: 100vh;
            align-items: center;
            justify-content: center;
            align-content: center;
        }

        .form form{
            background-color: #ccc;
            width: 400px;
            height: 400px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: center;
            align-content: center;
            border-radius: 30px;
            justify-content: center;
        

        }
        input{
            height: 30px;
            width: 250px;
        }
        button{
            width: 150px;
            height: 30px;
            margin-bottom: 30px;
        }
        .messageDiv{
            margin: 10px;
            padding: 10px 20px;
            border-radius: 5px;
            font-size: 1rem;
            opacity: 0;

        }
        .form{
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            align-content: center;
        }
        
     
    </style>
    <!-- <script type="module" src="sign.js"></script> -->
</head>
<body>
 
    

    <!-- signin -->

    <div class="form" id="signInForm">
        <form  id="lForm">
            <h2>login</h2>
            <input type="email" id="email" placeholder="Email">
            <span id="emailError"></span>
            <input type="password" id="pwd" placeholder="Password" >
            <span id="passwordError"></span>
            
                <button id="submitSignin">signIn</button>
            <span>Don't have an account?<a href="" id="rsignup">SignUp</a><span>
        </form>
    </div>
</div>
<script type="module">

    
    let submitsignin=document.getElementById("rsignin")
    let submitsignup=document.getElementById("rsignup")


    submitsignup.addEventListener("click",(e)=>{
        e.preventDefault()
    
      window.location.href="./signup.html"
    })



    // firebase


    // Import the functions you need from the SDKs you need
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.2.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword} from "https://www.gstatic.com/firebasejs/11.2.0/firebase-auth.js";
// import { getFirestore, setDoc,doc} from "https://www.gstatic.com/firebasejs/11.2.0/firebase-firestore.js";



// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyBbmBJPwfOKa2Q-r2CEhvsFv5yhmNFkuAU",
  authDomain: "login-kk-f580d.firebaseapp.com",
  projectId: "login-kk-f580d",
  storageBucket: "login-kk-f580d.firebasestorage.app",
  messagingSenderId: "901441715555",
  appId: "1:901441715555:web:5228323a42259e1e91a756"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);


function showMessage(message, divId) {  // More descriptive name: divId
    let messageDiv = document.getElementById(divId); // More descriptive name and correct capitalization
    if (!messageDiv) {  // Check if the element exists
        console.error("Div with ID '" + divId + "' not found!");
        return; // Exit early if the div doesn't exist
    }

    messageDiv.style.display = "block";
    messageDiv.innerHTML = message;
    messageDiv.style.opacity = 1; // Set opacity to 1 to make it visible

    setTimeout(function() {
        messageDiv.style.opacity = 0; // Fade out the message
      // Delay to allow fade-out to complete (adjust as needed)
    }, 2000); // Delay before fade-out starts
}



// sign in 

let signin = document.getElementById("submitSignin");

signin.addEventListener("click", (event) => {
    event.preventDefault(); // Prevent form submission

    let email = document.getElementById("email").value;
    let password = document.getElementById("pwd").value;

    const auth = getAuth(); // Make sure getAuth() is imported correctly

    signInWithEmailAndPassword(auth, email, password)
        .then((userCredential) => {
            showMessage("Login is successful", "signinmessage"); // Corrected typo here
            const user = userCredential.user;
            localStorage.setItem('loggedInUserId',user.uid);
            window.location.href = "loginpage.html"; // Redirect after successful login
        })
        .catch((error) => {
            const errorCode = error.code;
            const errorMessage = error.message; // Good practice to use the message too
            console.error("Login error:", errorCode, errorMessage); // Log for debugging

            if (errorCode === "auth/invalid-credential") { // Corrected typo here
                showMessage('Incorrect email or password', "signinmessage"); // Corrected typo here
            } else if (errorCode === "auth/user-not-found") {  // More specific error check
                showMessage("Account does not exist", "signinmessage"); // Corrected typo here
            } else {
                showMessage("An error occurred during login. Please try again.", "signinmessage"); // Generic message
                // Optionally display the full error message for debugging (not in production):
                // showMessage(errorMessage, "signinmessage");
            }
        });
});

    

</script>
<!-- <script src="sign.js"></script> -->
<!-- <script type="module" ></script> -->

</body>
</html>